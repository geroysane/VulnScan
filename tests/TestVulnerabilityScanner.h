#ifndef TESTVULNERABILITYSCANNER_H
#define TESTVULNERABILITYSCANNER_H

#include <QObject>
#include <QTest>
#include <QSignalSpy>

/**
 * @class TestVulnerabilityScanner
 * @brief Unit tests for VulnerabilityScanner class
 *
 * Tests:
 * - Scanner initialization
 * - Vulnerability assessment workflow
 * - Progress tracking
 * - Result aggregation
 * - Error handling
 */
class TestVulnerabilityScanner : public QObject {
    Q_OBJECT

private slots:
    // Setup and cleanup
    void initTestCase();
    void cleanupTestCase();
    void init();
    void cleanup();

    // Basic functionality tests
    void testScannerInitialization();
    void testAssessEmptyScanResults();
    void testAssessSingleService();
    void testAssessMultipleServices();

    // Signal tests
    void testProgressSignal();
    void testFinishedSignal();
    void testVulnerabilityFoundSignal();

    // State tests
    void testIsScanningState();
    void testCancelAssessment();
    void testGetResults();

    // Integration tests
    void testAssessWithVulnerabilities();
    void testAssessWithoutVulnerabilities();
    void testAssessServicesWithoutVersion();

private:
    QString m_testDbPath;
};

#endif // TESTVULNERABILITYSCANNER_H
